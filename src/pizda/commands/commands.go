package commands

import (
	"bot/src/bot"
	"bot/src/common"
	"bot/src/pizda/db"
	"bot/src/pizda/utils/const"
	t "bot/src/utils/types"
)

func Start(bot *bot.Bot, u t.Update) {
	var user t.User

	if u.FromChat() == nil {
		user = u.MyChatMember.From
	} else {
		user = *u.Message.From
	}

	bot.SendMessage(
		common.GenerateKeyboardMsg(
			user.ID,
			cnst.SaleKeyboard,
			"‚¨áÔ∏è –í–Ω–∏–∑—É, –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞, –µ—Å—Ç—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞",
		),
	)

	if u.Message == nil || u.Message.Text == "/start" {
		// 		payments, err := db.Query.IfUserPays(bot.Ctx, user.ID)

		// 		if err != nil {
		// 			bot.Error("p start error: " + err.Error())
		// 		}

		bot.SendPhoto(t.Message{
			ChatId: user.ID,
			Caption:   "–ü—Ä–∏–≤–µ—Ç –ø–æ–¥—Ä—É–≥–∞ü´∞  \n–ú–µ–Ω—è –∑–æ–≤—É—Ç –í–∏–æ–ª–µ—Ç—Ç–∞. –Ø –π–æ–≥–∞-—Ç–µ—Ä–∞–ø–µ–≤—Ç –≤ –æ–±–ª–∞—Å—Ç–∏ –∂–µ–Ω—Å–∫–æ–≥–æ –∑–¥–æ—Ä–æ–≤—å—è .–ú–æ—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –Ω–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ –≥–∏–Ω–µ–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å–∏—Å—Ç–µ–º—ã –∂–µ–Ω—â–∏–Ω—ã, –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏ –æ—Ä–≥–∞–Ω–∏–∑–º–∞ –∏ –∫–æ—Ä—Ä–µ–∫—Ü–∏—é –ø—Å–∏—Ö–æ-—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è.\n\n–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π –π–æ–≥–∏, –∫–æ—Ç–æ—Ä–∞—è –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ —Ç–µ–ª–∞ –∏ —Å–æ–∑–Ω–∞–Ω–∏—è –º—É–∂—á–∏–Ω –∏ –∂–µ–Ω—â–∏–Ω, –∑–¥–µ—Å—å —è –ø—Ä–µ–¥–ª–∞–≥–∞—é –±–æ–ª–µ–µ –º—è–≥–∫–∏–π, –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏ —Ü–µ–ª–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥, —É—á–∏—Ç—ã–≤–∞—é—â–∏–π —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è –∏ —Ü–µ–ª–∏ –º–æ–ª–æ–¥—ã—Ö –∂–µ–Ω—â–∏–Ω. –≠—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, –∞ –≤—ã—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–≤–µ–¥–µ—Ç —Ç–µ–±—è –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º –≤ –¥–≤–∏–∂–µ–Ω–∏–∏, –¥—ã—Ö–∞–Ω–∏–∏, —Å–ø–æ—Ä—Ç–µ.",
			Text:   "–ü—Ä–∏–≤–µ—Ç –ø–æ–¥—Ä—É–≥–∞ü´∞  \n–ú–µ–Ω—è –∑–æ–≤—É—Ç –í–∏–æ–ª–µ—Ç—Ç–∞. –Ø –π–æ–≥–∞-—Ç–µ—Ä–∞–ø–µ–≤—Ç –≤ –æ–±–ª–∞—Å—Ç–∏ –∂–µ–Ω—Å–∫–æ–≥–æ –∑–¥–æ—Ä–æ–≤—å—è .–ú–æ—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –Ω–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ –≥–∏–Ω–µ–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å–∏—Å—Ç–µ–º—ã –∂–µ–Ω—â–∏–Ω—ã, –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏ –æ—Ä–≥–∞–Ω–∏–∑–º–∞ –∏ –∫–æ—Ä—Ä–µ–∫—Ü–∏—é –ø—Å–∏—Ö–æ-—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è.\n\n–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π –π–æ–≥–∏, –∫–æ—Ç–æ—Ä–∞—è –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ —Ç–µ–ª–∞ –∏ —Å–æ–∑–Ω–∞–Ω–∏—è –º—É–∂—á–∏–Ω –∏ –∂–µ–Ω—â–∏–Ω, –∑–¥–µ—Å—å —è –ø—Ä–µ–¥–ª–∞–≥–∞—é –±–æ–ª–µ–µ –º—è–≥–∫–∏–π, –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏ —Ü–µ–ª–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥, —É—á–∏—Ç—ã–≤–∞—é—â–∏–π —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è –∏ —Ü–µ–ª–∏ –º–æ–ª–æ–¥—ã—Ö –∂–µ–Ω—â–∏–Ω. –≠—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, –∞ –≤—ã—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–≤–µ–¥–µ—Ç —Ç–µ–±—è –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º –≤ –¥–≤–∏–∂–µ–Ω–∏–∏, –¥—ã—Ö–∞–Ω–∏–∏, —Å–ø–æ—Ä—Ç–µ.",
			Photo: "AgACAgIAAxkBAAIiSWkN8UDfFDM5rQ-OmIEkpBj65TzFAAIJD2sb55ZwSDJcoB39mgTjAQADAgADcwADNgQ",
			ReplyMarkup: &t.InlineKeyboardMarkup{
				InlineKeyboard: [][]t.InlineKeyboardButton{
					{
						{
							Text:         "–î–∞–≤–∞–π —É–∑–Ω–∞–µ–º, –ø–æ–¥—Ö–æ–¥–∏—Ç –ª–∏ —Ç–µ–±–µ —ç—Ç–æ—Ç –∫—É—Ä—Åü§î?",
							CallbackData: cnst.Whom,
						},
					},
				},
			},
		})

		db.Query.UpsertUser(bot.Ctx, db.UpsertUserParams{
			ID:        user.ID,
			FirstName: user.FirstName,
			LastName:  user.LastName,
			Username:  user.UserName,
		})
	}
}
